@using System.Globalization
@using ZipishLens.Signature
<ul>
    @foreach (var (cert, i) in Signature.Certificates.Select((certificate, i) => (certificate, i)))
    {
        <li>
            @(cert.IsIntermediate(Signature.Certificates) ? "Intermediate Certificate" : "Certificate")
            <ul>
                <li>Issuer: @(cert.CertInfo.Issuer)</li>
                <li>
                    Validity
                    <ul>
                        <li>Not Before: @(FormatDateTime(cert.CertInfo.Validity.NotBefore))</li>
                        <li>Not After: @(FormatDateTime(cert.CertInfo.Validity.NotAfter))</li>
                    </ul>
                </li>
                <li>Subject: @(cert.CertInfo.Subject)</li>
            </ul>
        </li>
    }
</ul>

@code {
    [Parameter] public required SignedData Signature { get; set; }

    public string FormatDateTime(DateTime dateTime) => dateTime.ToString("MMM dd HH:mm:ss yyyy 'GMT'", CultureInfo.InvariantCulture);
}
