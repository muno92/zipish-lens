@using System.Text.Json
@if (new [] {"jpg", "jpeg", "png"}.Contains(Extension))
{
    <img src="data:image/@( Extension );base64,@( Convert.ToBase64String(File.ReadAllBytes(FilePath)) )" />
}
else if(new [] {"txt", "json", "xml"}.Contains(Extension))
{
    <pre>@ReadTextFile(FilePath)</pre>
}

@code {
    [Parameter]
    public required string FilePath { get; set; }

    private string Extension => Path.GetExtension(FilePath).TrimStart('.');

    private string ReadTextFile(string filePath)
    {
        if (Extension == "json")
        {
            return FormatJson(File.ReadAllText(filePath));
        }

        return File.ReadAllText(filePath);
    }

    private static string FormatJson(string jsonContent)
    {
        // Unminify minified JSON for better readability
        return JsonSerializer.Serialize(JsonSerializer.Deserialize<object>(jsonContent), new JsonSerializerOptions { WriteIndented = true });
    }

}
